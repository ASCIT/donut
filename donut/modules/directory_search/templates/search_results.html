{% extends 'layout.html' %}
{% block page %}
	<div class='container theme-showcase jumbotron' style='float: none; padding-bottom: 25px'>
		<a class='btn btn-info' href='{{ url_for("directory_search.directory_search") }}'>Back</a>
		<div>Your search returned {{ total }} results</div>
		{% if users %}
                                <label for='per_page'>Results per page</label>
                                <select class='form-control' id='per_page'>
                                        {% for i in range(10, 50, 10) %}
                                                <option value=i>{{ i }}</option>
                                        {% endfor %}
                                </select>
                        </div>

			<table class='table table-striped table-condensed'>
				<thead>
					<tr>
						<th>Name</th>
						<th>Graduation Year</th>
						{% if show_images %}
							<th> Image </th>
						{% endif %}
					</tr>
				</thead>
				<tbody>
					{% for user in users %}
						<tr>
							<td>
								<a href='{{ url_for("directory_search.view_user", user_id=user["user_id"]) }}'>
									{{ user['full_name'] }}
								</a>
							</td>
							<td>{{ user['graduation_year'] or '' }}</td>
							{% if show_images %}
								<td>
									{% if user['image'] %}
										<img
											src='{{ url_for("directory_search.get_image", user_id=user["user_id"]) }}'
											style='max-width: 100px; max-height: 150px'
										/>
									{% endif %}
								</td>
							{% endif %}
						</tr>
					{% endfor %}
				</tbody>
			</table>
			<ul class="pagination">
	<li class="page-item {% if page == 1 %} disabled {% endif %}">
		<a class="page-link" {% if page != 1 %} href="{{ url_for('directory_search.search', page=page-1, per_page=per_page, total=total, num_pgs=num_pgs, **query_info) }}" {% endif %} aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
        <span class="sr-only">Previous</span>
      </a>
    </li>
    {% set num_pgs = total // per_page + (total % per_page > 0) %}
    {% for i in range(1, num_pgs+1) %}
    <li class="page-item {% if i == page %} active {% endif %}">
	    <a class="page-link" href="{{ url_for('directory_search.search', page=i, per_page=per_page, total=total, num_pgs=num_pgs, **query_info) }}">{{ i }}</a>
    </li>
    {% endfor %}
    <li class="page-item {% if page == num_pgs %} disabled {% endif %}">
	    <a class="page-link" {% if page != num_pgs %} href="{{ url_for('directory_search.search', page=page+1, per_page=per_page, total=total, **query_info) }}" {% endif %} aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
        <span class="sr-only">Next</span>
      </a>
    </li>
  </ul>
  {% endif %}
	</div>
{% endblock %}
{% block scripts %}
{{ super() }}
	<script>
		$('#per_page').change(function() {
			var p = this.val();
			window.location.href = "{{ url_for('directory_search.search', per_page=p, page=page+1, total=total, **query_info) | safe }}";
		});
	</script>
{% endblock %}
