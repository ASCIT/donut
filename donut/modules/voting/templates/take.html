{% extends 'layout.html' %}
{% block page %}
<div class="container theme-showcase">
	<div class="jumbotron">
		<ul id="question_container">
		</ul>
	</div>
</div>
{% endblock %}
{% block scripts %}
    {{ super() }}
    <script>
        var QUESTION_TYPES = {{ question_types|safe }}
        var questionData = {{ questions_json|safe }}
	
        $(document).ready(function() {
		var questionContainer = $('#question_container')

		questionData.forEach(function(question) {
			var questionType = question.type
			var title = question.title
			var desc = question.description
			var h4 = $('<h4>').text(title)
			var li = $('<li>').attr('question_type', questionType)
			var pd = $('<p>').text(desc)

			li.append(h4, pd)

			switch (Number(questionType)) {
				case QUESTION_TYPES.Dropdown:
					var select = $('<select>').addClass('form-control choices')

					question.choices.forEach(function(choice) {
						select.append($('<option>' + choice + '</option>'))
					})

					li.append($('<div>').append(select))
					break
				case QUESTION_TYPES['Elected position']:
					var container = $('<div>').addClass('slidecontainer')
					var choicelen = question.choices.length

					question.choices.forEach(function(choice) {
						var subcontainer = $('<div>')
						subcontainer.append($('<p>').text(choice))					
						var slider = $('<input>').attr('type', 'range')
									 .attr('min', '1')
								      	 .attr('max', choicelen)
									 .attr('value', '1')
									 .addClass('slider')
									 .change(updateSliderVal)
						subcontainer.append(slider)

						subcontainer.append($('<p>').text("Value: 1"))

						container.append(subcontainer)
					})

					li.append($('<div>').append(container))
					break
				case QUESTION_TYPES.Checkboxes:
					var container = $('<div>').addClass('form-control choices')
					
					question.choices.forEach(function(choice) {
						container.append($('<label>').text(choice).append(	
							$('<input>').attr('type', 'checkbox')
							)
						)

					})

					li.append($('<div>').append(container))
					break
				case QUESTION_TYPES['Short text']:
					li.append(
						$('<div>').append($('<input>').attr('type', 'text').addClass('form-control'))
					)
					break
				case QUESTION_TYPES['Long text']:
					li.append(
						$('<div>').append($('<textarea>').addClass('form-control'))
					)
					break
			}
			questionContainer.append(li)
		})
	})

	function updateSliderVal() {
		var p = $(this).parent().children('p').last()
		p.text("Value: " + $(this).val())
	}
    </script>
{% endblock %}
